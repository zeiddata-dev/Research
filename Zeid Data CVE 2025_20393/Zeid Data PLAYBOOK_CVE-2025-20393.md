# Zeid Data - Copper Hang Back...
# Zeid Data SOC Playbook — CVE-2025-20393 (Cisco AsyncOS Spam Quarantine)

**Goal:** Rapidly identify exposure, contain risk, upgrade to fixed releases, and generate audit-ready evidence.

---

## 1) Scope & trigger

**In scope**
- Cisco Secure Email Gateway (ESA / SEG) running Cisco AsyncOS
- Cisco Secure Email & Web Manager (SMA / SEWM) running Cisco AsyncOS

**Trigger**
- You operate ESA/SMA
- You observe unexpected HTTP activity against the Spam Quarantine service
- You see unexplained privileged execution or appliance anomalies
- You cannot confirm whether Spam Quarantine was exposed externally

---

## 2) What the vulnerability enables (risk statement)

- Unauthenticated, remote command execution with **root** privileges via crafted HTTP requests to Spam Quarantine.
- Root cause: insufficient validation of HTTP requests in the Spam Quarantine feature.
- Treat impacted appliances as “edge” systems with high-impact compromise potential.

---

## 3) Roles & coordination

- **Incident Commander (IC):** Security lead (SOC manager / IR lead)
- **System Owner:** Email security engineering / messaging team
- **Network Owner:** Firewall / perimeter team
- **Change Manager:** CAB / ITSM owner
- **Vendor liaison:** Cisco TAC contact (if compromise suspected or upgrade issues)

---

## 4) Identification (inventory + version proof)

**Objective:** Create a definitive list of all ESA/SMA assets and their versions.

**Actions**
1. Build inventory:
   - Hostname, serial/VM ID, management IP, external NAT/public exposure, cluster membership
2. Pull **AsyncOS version** from each appliance (CLI `version` output)
3. Compare against fixed-release targets for your product/train.

**Evidence to capture**
- Raw `version` output (timestamped)
- Asset inventory export (CSV)
- Change ticket IDs created for each appliance

**Zeid Data SAFE tooling**
- Use the Zeid Data read-only planner to collect versions and generate a patch runbook (no changes performed).

---

## 5) Exposure determination (is it reachable?)

**Objective:** Confirm whether Spam Quarantine is both enabled and reachable from the internet.

**Actions**
1. Validate configuration:
   - Confirm whether Spam Quarantine is enabled on any internet-facing interface
2. Validate reachability:
   - Firewall/NAT review: inbound rules permitting access to the relevant management/quarantine service
   - External posture: confirm if any public IPs route to the service

**Immediate containment if uncertain**
- Restrict inbound access to trusted administrative networks only (allowlist)
- Remove direct internet exposure of admin/quarantine services
- Document the change and owners

**Evidence to capture**
- Screenshots of interface settings (Spam Quarantine enabled/disabled)
- Firewall rule exports (before/after)
- NAT / load balancer mappings (before/after)

---

## 6) Containment (stop the bleeding)

**When to contain**
- Exposure confirmed
- Exposure cannot be ruled out quickly
- Indicators suggest suspicious activity

**Containment steps**
- Block/allowlist inbound access at perimeter immediately
- Isolate the appliance management plane from the public internet
- If compromise suspected: isolate affected appliance(s) from the network except for controlled admin access

**Evidence**
- Firewall change diff (rule ID, timestamp, approver)
- Network diagram snippet showing isolation control

---

## 7) Detection & triage (no exploit details)

**Objective:** Determine whether exploitation or post-exploitation behavior may have occurred.

**Data sources**
- Appliance access logs / HTTP request logs related to Spam Quarantine service
- Administrative login records (new accounts, unusual access patterns)
- System event logs, process/service anomalies, unexpected outbound connections
- IDS/Proxy logs for tunneling patterns from the appliance

**Triage questions**
- Were there inbound requests to the Spam Quarantine service from unexpected sources?
- Are there signs of privileged execution or persistence on the appliance?
- Are there unexpected outbound connections or tunneling behavior?
- Did the appliance configuration change outside of approved change windows?

**Escalation**
- If any evidence suggests compromise, escalate to IR and engage Cisco TAC.

---

## 8) Eradication & remediation (patch)

**Objective:** Upgrade to fixed software for your train and verify.

**Actions**
1. Follow your approved upgrade path (per vendor guidance) for ESA/SMA.
2. Execute the upgrade during a controlled maintenance window.
3. Reboot as required and validate service health.

**Post-upgrade verification**
- Re-run `version` and store output
- Confirm reachability controls remain (no accidental re-exposure)
- Validate mail flow / management functions as expected

**Evidence**
- Before/after `version` outputs
- Maintenance window record and approvals
- Post-change validation checklist signed off

---

## 9) Recovery & monitoring

**Actions**
- Increase monitoring for the appliance’s admin plane and outbound traffic for 7–14 days
- Alert on unexpected changes to email security policies/configs
- Re-assess internet exposure controls after change completion

---

## 10) Auditor-ready evidence pack (Zeid Data style)

**Minimum evidence bundle**
- Inventory list + owners
- Exposure decision log (enabled? reachable? how determined)
- Firewall/NAT change evidence
- Before/after versions
- Change ticket IDs + approvals
- Validation checklist results

**Chain-of-custody**
- Timestamp every artifact
- Hash log exports and configs (SHA-256) and store hashes separately

---

## 11) Closeout

- Document root cause (exposure path + version state)
- Capture lessons learned (why exposed, what failed in change control)
- Add guardrails:
  - “No direct internet exposure” policy for admin/quarantine interfaces
  - Continuous exposure monitoring for edge appliances
  - Patch SLAs for KEV-listed vulnerabilities
