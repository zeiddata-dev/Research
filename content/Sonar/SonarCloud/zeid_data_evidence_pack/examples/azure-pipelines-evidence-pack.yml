# Azure Pipelines example: generate evidence pack and publish artifact
# Define variables/secrets: SONAR_HOST_URL, SONAR_TOKEN

trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

steps:
  - checkout: self

  - script: |
      python3 zeid_data_sonar_evidence_pack.py --project-key "YOUR_PROJECT_KEY" --outdir "./out" --raw
    displayName: "Generate Sonar evidence pack"
    env:
      SONAR_HOST_URL: $(SONAR_HOST_URL)
      SONAR_TOKEN: $(SONAR_TOKEN)

  - task: PublishBuildArtifacts@1
    inputs:
      PathtoPublish: 'out'
      ArtifactName: 'sonar-evidence-pack'
      publishLocation: 'Container'
